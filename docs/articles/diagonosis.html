<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Data quality diagnosis • dlookr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Data quality diagnosis">
<meta property="og:description" content="dlookr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dlookr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.6.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/introduce.html">Introduce dlookr</a>
</li>
<li>
  <a href="../articles/diagonosis.html">Data Diagnosis</a>
</li>
<li>
  <a href="../articles/EDA.html">EDA</a>
</li>
<li>
  <a href="../articles/transformation.html">Data Transformation</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../reference/index.html">Function reference</a>
</li>
<li>
  <a href="https://github.com/choonghyunryu/dlookr/">
    <span class="fas fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="diagonosis_files/header-attrs-2.8/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Data quality diagnosis</h1>
                        <h4 class="author">Choonghyun Ryu</h4>
            
            <h4 class="date">2021-08-01</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/choonghyunryu/dlookr/blob/master/vignettes/diagonosis.Rmd"><code>vignettes/diagonosis.Rmd</code></a></small>
      <div class="hidden name"><code>diagonosis.Rmd</code></div>

    </div>

    
    
<div id="preface" class="section level2">
<h2 class="hasAnchor">
<a href="#preface" class="anchor"></a>Preface</h2>
<p>After you have acquired the data, you should do the following:</p>
<ul>
<li>
<strong>Diagnose data quality.</strong>
<ul>
<li><strong>If there is a problem with data quality,</strong></li>
<li><strong>The data must be corrected or re-acquired.</strong></li>
</ul>
</li>
<li>Explore data to understand the data and find scenarios for performing the analysis.</li>
<li>Derive new variables or perform variable transformations.</li>
</ul>
<p>The dlookr package makes these steps fast and easy:</p>
<ul>
<li><strong>Performs a data diagnosis or automatically generates a data diagnosis report.</strong></li>
<li>Discover data in a variety of ways, and automatically generate EDA(exploratory data analysis) report.</li>
<li>Impute missing values and outliers, resolve skewed data, and categorize continuous variables into categorical variables. And generates an automated report to support it.</li>
</ul>
<p>This document introduces <strong>Data Quality Diagnosis</strong> methods provided by the dlookr package. You will learn how to diagnose the quality of <code>tbl_df</code> data that inherits from data.frame and <code>data.frame</code> with functions provided by dlookr.</p>
<p>dlookr increases synergy with <code>dplyr</code>. Particularly in data exploration and data wrangle, it increases the efficiency of the <code>tidyverse</code> package group.</p>
</div>
<div id="supported-data-structures" class="section level2">
<h2 class="hasAnchor">
<a href="#supported-data-structures" class="anchor"></a>Supported data structures</h2>
<p>Data diagnosis supports the following data structures.</p>
<ul>
<li>data frame : data.frame class.</li>
<li>data table : tbl_df class.</li>
<li>
<strong>table of DBMS</strong> : table of the DBMS through tbl_dbi.
<ul>
<li><strong>Use dplyr as the back-end interface for any DBI-compatible database.</strong></li>
</ul>
</li>
</ul>
</div>
<div id="data-nycflights13" class="section level2">
<h2 class="hasAnchor">
<a href="#data-nycflights13" class="anchor"></a>Data: nycflights13</h2>
<p>To illustrate basic use of the dlookr package, use the <code>flights</code> data from the <code>nycflights13</code> package. The <code>flights</code> data frame is data about departure and arrival on all flights departing from NYC in 2013.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r">library(nycflights13)
dim(flights)
[1] 336776     19
flights
# A tibble: 336,776 x 19
   year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
  &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
1  2013     1     1      517            515         2      830            819
2  2013     1     1      533            529         4      850            830
3  2013     1     1      542            540         2      923            850
4  2013     1     1      544            545        -1     1004           1022
# … with 336,772 more rows, and 11 more variables: arr_delay &lt;dbl&gt;,
#   carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;,
#   air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</pre></body></html></div>
</div>
<div id="data-diagnosis" class="section level2">
<h2 class="hasAnchor">
<a href="#data-diagnosis" class="anchor"></a>Data diagnosis</h2>
<p>dlookr aims to diagnose the data and to select variables that can not be used for data analysis or to find the variables that need to be calibrated.:</p>
<ul>
<li>
<code><a href="../reference/diagnose.data.frame.html">diagnose()</a></code> provides basic diagnostic information for variables.</li>
<li>
<code><a href="../reference/diagnose_category.data.frame.html">diagnose_category()</a></code> provides detailed diagnostic information for categorical variables.</li>
<li>
<code><a href="../reference/diagnose_numeric.data.frame.html">diagnose_numeric()</a></code> provides detailed diagnostic information for numerical variables.</li>
<li>
<code><a href="../reference/diagnose_outlier.data.frame.html">diagnose_outlier()</a></code> and <code><a href="../reference/plot_outlier.data.frame.html">plot_outlier()</a></code> provide information and visualization of outliers.</li>
</ul>
<div id="general-diagnosis-of-all-variables-with-diagnose" class="section level3">
<h3 class="hasAnchor">
<a href="#general-diagnosis-of-all-variables-with-diagnose" class="anchor"></a>General diagnosis of all variables with <code>diagnose()</code>
</h3>
<p><code><a href="../reference/diagnose.data.frame.html">diagnose()</a></code> allows to diagnosis a variables in a data frame. Like function of dplyr, the first argument is the tibble (or data frame). The second and subsequent arguments refer to variables within that data frame.</p>
<p>The variables of the <code>tbl_df</code> object returned by <code><a href="../reference/diagnose.data.frame.html">diagnose ()</a></code> are as follows.</p>
<ul>
<li>
<code>variables</code> : variable names</li>
<li>
<code>types</code> : the data type of the variables</li>
<li>
<code>missing_count</code> : number of missing values</li>
<li>
<code>missing_percent</code> : percentage of missing values</li>
<li>
<code>unique_count</code> : number of unique values</li>
<li>
<code>unique_rate</code> : rate of unique value. unique_count / number of observation</li>
</ul>
<p>For example, we can diagnose all variables in <code>flights</code>:</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r">diagnose(flights)
# A tibble: 19 x 6
  variables types   missing_count missing_percent unique_count unique_rate
  &lt;chr&gt;     &lt;chr&gt;           &lt;int&gt;           &lt;dbl&gt;        &lt;int&gt;       &lt;dbl&gt;
1 year      integer             0            0               1  0.00000297
2 month     integer             0            0              12  0.0000356 
3 day       integer             0            0              31  0.0000920 
4 dep_time  integer          8255            2.45         1319  0.00392   
# … with 15 more rows</pre></body></html></div>
<ul>
<li>
<code>Missing Value(NA)</code> : Variables with many missing values, ie those with a <code>missing_percent</code> close to 100, should be excluded from the analysis.</li>
<li>
<code>Unique value</code> : Variables with a unique value (<code>unique_count</code> = 1) are considered to be excluded from data analysis. And if the data type is not numeric (integer, numeric) and the number of unique values is equal to the number of observations (unique_rate = 1), then the variable is likely to be an identifier. Therefore, this variable is also not suitable for the analysis model.</li>
</ul>
<p><code>year</code> can be considered not to be used in the analysis model since <code>unique_count</code> is 1. However, you do not have to remove it if you configure <code>date</code> as a combination of <code>year</code>, <code>month</code>, and <code>day</code>.</p>
<p>For example, we can diagnose only a few selected variables:</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"># Select columns by name
diagnose(flights, year, month, day)
# A tibble: 3 x 6
  variables types   missing_count missing_percent unique_count unique_rate
  &lt;chr&gt;     &lt;chr&gt;           &lt;int&gt;           &lt;dbl&gt;        &lt;int&gt;       &lt;dbl&gt;
1 year      integer             0               0            1  0.00000297
2 month     integer             0               0           12  0.0000356 
3 day       integer             0               0           31  0.0000920 
# Select all columns between year and day (include)
diagnose(flights, year:day)
# A tibble: 3 x 6
  variables types   missing_count missing_percent unique_count unique_rate
  &lt;chr&gt;     &lt;chr&gt;           &lt;int&gt;           &lt;dbl&gt;        &lt;int&gt;       &lt;dbl&gt;
1 year      integer             0               0            1  0.00000297
2 month     integer             0               0           12  0.0000356 
3 day       integer             0               0           31  0.0000920 
# Select all columns except those from year to day (exclude)
diagnose(flights, -(year:day))
# A tibble: 16 x 6
  variables      types   missing_count missing_percent unique_count unique_rate
  &lt;chr&gt;          &lt;chr&gt;           &lt;int&gt;           &lt;dbl&gt;        &lt;int&gt;       &lt;dbl&gt;
1 dep_time       integer          8255            2.45         1319     0.00392
2 sched_dep_time integer             0            0            1021     0.00303
3 dep_delay      numeric          8255            2.45          528     0.00157
4 arr_time       integer          8713            2.59         1412     0.00419
# … with 12 more rows</pre></body></html></div>
<p>By using with dplyr, variables including missing values can be sorted by the weight of missing values.:</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r">flights %&gt;%
  diagnose() %&gt;%
  select(-unique_count, -unique_rate) %&gt;% 
  filter(missing_count &gt; 0) %&gt;% 
  arrange(desc(missing_count))
# A tibble: 6 x 4
  variables types   missing_count missing_percent
  &lt;chr&gt;     &lt;chr&gt;           &lt;int&gt;           &lt;dbl&gt;
1 arr_delay numeric          9430            2.80
2 air_time  numeric          9430            2.80
3 arr_time  integer          8713            2.59
4 dep_time  integer          8255            2.45
# … with 2 more rows</pre></body></html></div>
</div>
<div id="diagnosis-of-numeric-variables-with-diagnose_numeric" class="section level3">
<h3 class="hasAnchor">
<a href="#diagnosis-of-numeric-variables-with-diagnose_numeric" class="anchor"></a>Diagnosis of numeric variables with <code>diagnose_numeric()</code>
</h3>
<p><code><a href="../reference/diagnose_numeric.data.frame.html">diagnose_numeric()</a></code> diagnoses numeric(continuous and discrete) variables in a data frame. Usage is the same as <code><a href="../reference/diagnose.data.frame.html">diagnose()</a></code> but returns more diagnostic information. However, if you specify a non-numeric variable in the second and subsequent argument list, the variable is automatically ignored.</p>
<p>The variables of the <code>tbl_df</code> object returned by <code><a href="../reference/diagnose_numeric.data.frame.html">diagnose_numeric()</a></code> are as follows.</p>
<ul>
<li>
<code>min</code> : minimum value</li>
<li>
<code>Q1</code> : 1/4 quartile, 25th percentile</li>
<li>
<code>mean</code> : arithmetic mean</li>
<li>
<code>median</code> : median, 50th percentile</li>
<li>
<code>Q3</code> : 3/4 quartile, 75th percentile</li>
<li>
<code>max</code> : maximum value</li>
<li>
<code>zero</code> : number of observations with a value of 0</li>
<li>
<code>minus</code> : number of observations with negative numbers</li>
<li>
<code>outlier</code> : number of outliers</li>
</ul>
<p>The summary() function summarizes the distribution of individual variables in the data frame and outputs it to the console. The summary values of numeric variables are <code>min</code>, <code>Q1</code>, <code>mean</code>, <code>median</code>, <code>Q3</code> and <code>max</code>, which help to understand the distribution of data.</p>
<p>However, the result displayed on the console has the disadvantage that the analyst has to look at it with the eyes. However, when the summary information is returned in a data frame structure such as tbl_df, the scope of utilization is expanded. <code><a href="../reference/diagnose_numeric.data.frame.html">diagnose_numeric()</a></code> supports this.</p>
<p><code>zero</code>, <code>minus</code>, and <code>outlier</code> are useful measures to diagnose data integrity. For example, numerical data in some cases cannot have zero or negative numbers. A numeric variable called <code>employee salary</code> cannot have negative numbers or zeros. Therefore, this variable should be checked for the inclusion of zero or negative numbers in the data diagnosis process.</p>
<p><code><a href="../reference/diagnose_numeric.data.frame.html">diagnose_numeric()</a></code> can diagnose all numeric variables of <code>flights</code> as follows.:</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r">diagnose_numeric(flights)
# A tibble: 14 x 10
  variables   min    Q1    mean median    Q3   max  zero minus outlier
  &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt;   &lt;int&gt;
1 year       2013  2013 2013      2013  2013  2013     0     0       0
2 month         1     4    6.55      7    10    12     0     0       0
3 day           1     8   15.7      16    23    31     0     0       0
4 dep_time      1   907 1349.     1401  1744  2400     0     0       0
# … with 10 more rows</pre></body></html></div>
<p>If a numeric variable can not logically have a negative or zero value, it can be used with <code><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter()</a></code> to easily find a variable that does not logically match:</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r">diagnose_numeric(flights) %&gt;% 
  filter(minus &gt; 0 | zero &gt; 0) 
# A tibble: 3 x 10
  variables   min    Q1  mean median    Q3   max  zero  minus outlier
  &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;  &lt;int&gt;   &lt;int&gt;
1 dep_delay   -43    -5 12.6      -2    11  1301 16514 183575   43216
2 arr_delay   -86   -17  6.90     -5    14  1272  5409 188933   27880
3 minute        0     8 26.2      29    44    59 60696      0       0</pre></body></html></div>
</div>
<div id="diagnosis-of-categorical-variables-with-diagnose_category" class="section level3">
<h3 class="hasAnchor">
<a href="#diagnosis-of-categorical-variables-with-diagnose_category" class="anchor"></a>Diagnosis of categorical variables with <code>diagnose_category()</code>
</h3>
<p><code><a href="../reference/diagnose_category.data.frame.html">diagnose_category()</a></code> diagnoses the categorical(factor, ordered, character) variables of a data frame. The usage is similar to <code><a href="../reference/diagnose.data.frame.html">diagnose()</a></code> but returns more diagnostic information. If you specify a non-categorical variable in the second and subsequent argument list, the variable is automatically ignored.</p>
<p>The <code>top</code> argument specifies the number of levels to return for each variable. The default is 10, which returns the top 10 level. Of course, if the number of levels is less than 10, all levels are returned.</p>
<p>The variables of the <code>tbl_df</code> object returned by <code><a href="../reference/diagnose_category.data.frame.html">diagnose_category()</a></code> are as follows.</p>
<ul>
<li>
<code>variables</code> : variable names</li>
<li>
<code>levels</code>: level names</li>
<li>
<code>N</code> : number of observation</li>
<li>
<code>freq</code> : number of observation at the levels</li>
<li>
<code>ratio</code> : percentage of observation at the levels</li>
<li>
<code>rank</code> : rank of occupancy ratio of levels</li>
</ul>
<p>`<code><a href="../reference/diagnose_category.data.frame.html">diagnose_category()</a></code> can diagnose all categorical variables of <code>flights</code> as follows.:</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r">diagnose_category(flights)
# A tibble: 43 x 6
  variables levels      N  freq ratio  rank
  &lt;chr&gt;     &lt;chr&gt;   &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;int&gt;
1 carrier   UA     336776 58665  17.4     1
2 carrier   B6     336776 54635  16.2     2
3 carrier   EV     336776 54173  16.1     3
4 carrier   DL     336776 48110  14.3     4
# … with 39 more rows</pre></body></html></div>
<p>In collaboration with <code><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter()</a></code> in the <code>dplyr</code> package, we can see that the <code>tailnum</code> variable is ranked in top 1 with 2,512 missing values in the case where the missing value is included in the top 10:</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r">diagnose_category(flights) %&gt;% 
  filter(is.na(levels))
# A tibble: 1 x 6
  variables levels      N  freq ratio  rank
  &lt;chr&gt;     &lt;chr&gt;   &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;int&gt;
1 tailnum   &lt;NA&gt;   336776  2512 0.746     1</pre></body></html></div>
<p>The following example returns a list where the level’s relative percentage is 0.01% or less. Note that the value of the <code>top</code> argument is set to a large value such as 500. If the default value of 10 was used, values below 0.01% would not be included in the list:</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r">flights %&gt;%
  diagnose_category(top = 500)  %&gt;%
  filter(ratio &lt;= 0.01)
# A tibble: 10 x 6
  variables levels      N  freq   ratio  rank
  &lt;chr&gt;     &lt;chr&gt;   &lt;int&gt; &lt;int&gt;   &lt;dbl&gt; &lt;int&gt;
1 carrier   OO     336776    32 0.00950    16
2 dest      JAC    336776    25 0.00742    97
3 dest      PSP    336776    19 0.00564    98
4 dest      EYW    336776    17 0.00505    99
# … with 6 more rows</pre></body></html></div>
<p>In the analytics model, you can also consider removing levels where the relative frequency is very small in the observations or, if possible, combining them together.</p>
</div>
<div id="diagnosing-outliers-with-diagnose_outlier" class="section level3">
<h3 class="hasAnchor">
<a href="#diagnosing-outliers-with-diagnose_outlier" class="anchor"></a>Diagnosing outliers with <code>diagnose_outlier()</code>
</h3>
<p><code><a href="../reference/diagnose_outlier.data.frame.html">diagnose_outlier()</a></code> diagnoses the outliers of the numeric (continuous and discrete) variables of the data frame. The usage is the same as <code><a href="../reference/diagnose.data.frame.html">diagnose()</a></code>.</p>
<p>The variables of the <code>tbl_df</code> object returned by <code><a href="../reference/diagnose_outlier.data.frame.html">diagnose_outlier()</a></code> are as follows.</p>
<ul>
<li>
<code>outliers_cnt</code> : number of outliers</li>
<li>
<code>outliers_ratio</code> : percent of outliers</li>
<li>
<code>outliers_mean</code> : arithmetic average of outliers</li>
<li>
<code>with_mean</code> : arithmetic average of with outliers</li>
<li>
<code>without_mean</code> : arithmetic average of without outliers</li>
</ul>
<p><code><a href="../reference/diagnose_outlier.data.frame.html">diagnose_outlier()</a></code> can diagnose outliers of all numerical variables on <code>flights</code> as follows:</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r">diagnose_outlier(flights)
# A tibble: 14 x 6
  variables outliers_cnt outliers_ratio outliers_mean with_mean without_mean
  &lt;chr&gt;            &lt;int&gt;          &lt;dbl&gt;         &lt;dbl&gt;     &lt;dbl&gt;        &lt;dbl&gt;
1 year                 0              0           NaN   2013         2013   
2 month                0              0           NaN      6.55         6.55
3 day                  0              0           NaN     15.7         15.7 
4 dep_time             0              0           NaN   1349.        1349.  
# … with 10 more rows</pre></body></html></div>
<p>Numeric variables that contained outliers are easily found with <code><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter()</a></code>.:</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r">diagnose_outlier(flights) %&gt;% 
  filter(outliers_cnt &gt; 0) 
# A tibble: 5 x 6
  variables outliers_cnt outliers_ratio outliers_mean with_mean without_mean
  &lt;chr&gt;            &lt;int&gt;          &lt;dbl&gt;         &lt;dbl&gt;     &lt;dbl&gt;        &lt;dbl&gt;
1 dep_delay        43216      12.8               93.1     12.6         0.444
2 arr_delay        27880       8.28             121.       6.90       -3.69 
3 flight               1       0.000297        8500     1972.       1972.   
4 air_time          5448       1.62             400.     151.        146.   
# … with 1 more row</pre></body></html></div>
<p>The following example finds a numeric variable with an outlier ratio of 5% or more, and then returns the result of dividing mean of outliers by overall mean in descending order:</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r">diagnose_outlier(flights) %&gt;% 
  filter(outliers_ratio &gt; 5) %&gt;% 
  mutate(rate = outliers_mean / with_mean) %&gt;% 
  arrange(desc(rate)) %&gt;% 
  select(-outliers_cnt)
# A tibble: 2 x 6
  variables outliers_ratio outliers_mean with_mean without_mean  rate
  &lt;chr&gt;              &lt;dbl&gt;         &lt;dbl&gt;     &lt;dbl&gt;        &lt;dbl&gt; &lt;dbl&gt;
1 arr_delay           8.28         121.       6.90       -3.69  17.5 
2 dep_delay          12.8           93.1     12.6         0.444  7.37</pre></body></html></div>
<p>In cases where the mean of the outliers is large relative to the overall average, it may be desirable to impute or remove the outliers.</p>
</div>
<div id="visualization-of-outliers-using-plot_outlier" class="section level3">
<h3 class="hasAnchor">
<a href="#visualization-of-outliers-using-plot_outlier" class="anchor"></a>Visualization of outliers using <code>plot_outlier()</code>
</h3>
<p><code><a href="../reference/plot_outlier.data.frame.html">plot_outlier()</a></code> visualizes outliers of numerical variables(continuous and discrete) of data.frame. Usage is the same <code><a href="../reference/diagnose.data.frame.html">diagnose()</a></code>.</p>
<p>The plot derived from the numerical data diagnosis is as follows.</p>
<ul>
<li>With outliers box plot</li>
<li>Without outliers box plot</li>
<li>With outliers histogram</li>
<li>Without outliers histogram</li>
</ul>
<p><code><a href="../reference/plot_outlier.data.frame.html">plot_outlier()</a></code> can visualize an outliers in the <code>arr_delay</code> variable of <code>flights</code> as follows:</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="no">flights</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/plot_outlier.data.frame.html">plot_outlier</a></span>(<span class="no">arr_delay</span>)</pre></body></html></div>
<p><img src="diagonosis_files/figure-html/plot_outlier-1.png" width="600px" style="display: block; margin: auto;"></p>
<p>The following example uses <code><a href="../reference/diagnose_outlier.data.frame.html">diagnose_outlier()</a></code>, <code><a href="../reference/plot_outlier.data.frame.html">plot_outlier()</a></code>, and <code>dplyr</code> packages to visualize all numerical variables with an outlier ratio of 5% or higher.</p>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="no">flights</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/plot_outlier.data.frame.html">plot_outlier</a></span>(<span class="fu"><a href="../reference/diagnose_outlier.data.frame.html">diagnose_outlier</a></span>(<span class="no">flights</span>) <span class="kw">%&gt;%</span>
                 <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="no">outliers_ratio</span> <span class="kw">&gt;=</span> <span class="fl">5</span>) <span class="kw">%&gt;%</span>
                 <span class="fu">select</span>(<span class="no">variables</span>) <span class="kw">%&gt;%</span>
                 <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>())</pre></body></html></div>
<p>Analysts should look at the results of the visualization to decide whether to remove or replace outliers. In some cases, you should consider removing variables with outliers from the data analysis model.</p>
<p>Looking at the results of the visualization, <code>arr_delay</code> shows that the observed values without outliers are similar to the normal distribution. In the case of a linear model, we might consider removing or imputing outliers.</p>
</div>
<div id="visualization-for-missing-values" class="section level3">
<h3 class="hasAnchor">
<a href="#visualization-for-missing-values" class="anchor"></a>Visualization for missing values</h3>
<p>It is important to look at the missing values of individual variables, but it is also important to look at the relationship between the variables including the missing values.</p>
<p>dlookr provides a visualization tool that looks at the relationship of variables including missing values.</p>
<div id="visualize-pareto-chart-using-plot_na_pareto" class="section level4">
<h4 class="hasAnchor">
<a href="#visualize-pareto-chart-using-plot_na_pareto" class="anchor"></a>visualize pareto chart using <code>plot_na_pareto()</code>
</h4>
<p><code><a href="../reference/plot_na_pareto.html">plot_na_pareto()</a></code> draws a pareto chart by collecting variables including missing values.</p>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="kw pkg">mice</span><span class="kw ns">::</span><span class="no"><a href="https://amices.org/mice/reference/boys.html">boys</a></span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/plot_na_pareto.html">plot_na_pareto</a></span>(<span class="kw">col</span> <span class="kw">=</span> <span class="st">"blue"</span>)</pre></body></html></div>
<p><img src="diagonosis_files/figure-html/plot_na_pareto1-1.png" width="600px" style="display: block; margin: auto;"></p>
<p>The default value of the <code>only_na</code> argument is FALSE, which includes variables that do not contain missing values, but if this value is set to TRUE, only variables containing missing values are visualized. The variable <code>age</code> was excluded from this plot.</p>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="kw pkg">mice</span><span class="kw ns">::</span><span class="no"><a href="https://amices.org/mice/reference/boys.html">boys</a></span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/plot_na_pareto.html">plot_na_pareto</a></span>(<span class="kw">only_na</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">"Pareto Chart for mice::boys"</span>)</pre></body></html></div>
<p>The rating of the variable is expressed as a proportion of missing values. It is calculated as the ratio of missing values. If it is [0, 0.05), it is <code>Good</code>, if it is [0.05, 0.4) it is <code>OK</code>, if it is [0.4, 0.8) it is <code>Bad</code>, and if it is [0.8, 1.0] it is <code>Remove</code>. You can override this grade using the <code>grade</code> argument as follows:</p>
<div class="sourceCode" id="cb17"><html><body><pre class="r"><span class="kw pkg">mice</span><span class="kw ns">::</span><span class="no"><a href="https://amices.org/mice/reference/boys.html">boys</a></span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/plot_na_pareto.html">plot_na_pareto</a></span>(<span class="kw">grade</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">High</span> <span class="kw">=</span> <span class="fl">0.1</span>, <span class="kw">Middle</span> <span class="kw">=</span> <span class="fl">0.6</span>, <span class="kw">Low</span> <span class="kw">=</span> <span class="fl">1</span>), <span class="kw">relative</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
<p>If the <code>plot</code> argument is set to FALSE, information about missing values is returned instead of plotting.</p>
<div class="sourceCode" id="cb18"><html><body><pre class="r"><span class="fu"><a href="../reference/plot_na_pareto.html">plot_na_pareto</a></span>(<span class="kw pkg">mice</span><span class="kw ns">::</span><span class="no"><a href="https://amices.org/mice/reference/boys.html">boys</a></span>, <span class="kw">only_na</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">plot</span> <span class="kw">=</span> <span class="fl">FALSE</span>)</pre></body></html></div>
</div>
<div id="visualize-combination-chart-using-plot_na_hclust" class="section level4">
<h4 class="hasAnchor">
<a href="#visualize-combination-chart-using-plot_na_hclust" class="anchor"></a>visualize combination chart using <code>plot_na_hclust()</code>
</h4>
<p>It is important to look at the relationship between variables, including missing values. <code><a href="../reference/plot_na_hclust.html">plot_na_hclust()</a></code> visualizes the relationship of variables that contain missing values. This function rearranges the positions of variables using hierarchical clustering. Then, the expression of the missing value is visualized by grouping similar variables.</p>
<div class="sourceCode" id="cb19"><html><body><pre class="r"><span class="kw pkg">mice</span><span class="kw ns">::</span><span class="no"><a href="https://amices.org/mice/reference/boys.html">boys</a></span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/plot_na_hclust.html">plot_na_hclust</a></span>(<span class="kw">main</span> <span class="kw">=</span> <span class="st">"Distribution of missing value"</span>)</pre></body></html></div>
<p><img src="diagonosis_files/figure-html/plot_na_hclust-1.png" width="600px" style="display: block; margin: auto;"></p>
</div>
<div id="visualize-combination-chart-using-plot_na_intersect" class="section level4">
<h4 class="hasAnchor">
<a href="#visualize-combination-chart-using-plot_na_intersect" class="anchor"></a>visualize combination chart using <code>plot_na_intersect()</code>
</h4>
<p><code><a href="../reference/plot_na_intersect.html">plot_na_intersect()</a></code> visualize the combinations of missing value across cases.</p>
<p>The visualization consists of four parts. The bottom left, which is the most basic, visualizes the case of cross(intersection)-combination. The x-axis is the variable including the missing value, and the y-axis represents the case of a combination of variables. And on the marginal of the two axes, the frequency of the case is expressed as a bar graph. Finally, the visualization at the top right expresses the number of variables including missing values in the data set, and the number of observations including missing values and complete cases .</p>
<p>This example visualize the combination variables that is include missing value.</p>
<div class="sourceCode" id="cb20"><html><body><pre class="r"><span class="kw pkg">mice</span><span class="kw ns">::</span><span class="no"><a href="https://amices.org/mice/reference/boys.html">boys</a></span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/plot_na_intersect.html">plot_na_intersect</a></span>()</pre></body></html></div>
<p><img src="diagonosis_files/figure-html/plot_na_hclust1-1.png" width="600px" style="display: block; margin: auto;"></p>
<p>If the <code>n_vars</code> argument is used, only the top <code>n</code> variables containing many missing values are visualized.</p>
<div class="sourceCode" id="cb21"><html><body><pre class="r"><span class="kw pkg">mice</span><span class="kw ns">::</span><span class="no"><a href="https://amices.org/mice/reference/boys.html">boys</a></span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/plot_na_intersect.html">plot_na_intersect</a></span>(<span class="kw">n_vars</span> <span class="kw">=</span> <span class="fl">5</span>)</pre></body></html></div>
<p>If you use the <code>n_intersacts</code> argument, only the top n numbers of variable combinations(intersection) including missing values are visualized. and If you want to visualize the combination variables that is include missing value and complete case. You just add only_na = FALSE.</p>
<div class="sourceCode" id="cb22"><html><body><pre class="r"><span class="kw pkg">mice</span><span class="kw ns">::</span><span class="no"><a href="https://amices.org/mice/reference/boys.html">boys</a></span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/plot_na_intersect.html">plot_na_intersect</a></span>(<span class="kw">only_na</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">n_intersacts</span> <span class="kw">=</span> <span class="fl">7</span>)</pre></body></html></div>
</div>
</div>
</div>
<div id="automated-report" class="section level2">
<h2 class="hasAnchor">
<a href="#automated-report" class="anchor"></a>Automated report</h2>
<p>dlookr provides two automated data diagnostic reports:</p>
<ul>
<li>Web page-based dynamic reports can perform in-depth analysis through visualization and statistical tables.</li>
<li>Static reports generated as pdf files or html files can be archived as output of data analysis.</li>
</ul>
<div id="create-a-diagnostic-report-using-diagnose_web_report" class="section level3">
<h3 class="hasAnchor">
<a href="#create-a-diagnostic-report-using-diagnose_web_report" class="anchor"></a>Create a diagnostic report using <code>diagnose_web_report()</code>
</h3>
<p><code><a href="../reference/diagnose_web_report.data.frame.html">diagnose_web_report()</a></code> create dynamic report for object inherited from data.frame(<code>tbl_df</code>, <code>tbl</code>, etc) or data.frame.</p>
<div id="contents-of-dynamic-web-report" class="section level4">
<h4 class="hasAnchor">
<a href="#contents-of-dynamic-web-report" class="anchor"></a>Contents of dynamic web report</h4>
<p>The contents of the report are as follows.:</p>
<ul>
<li>Overview
<ul>
<li>Data Structures
<ul>
<li>Data Structures</li>
<li>Data Types</li>
<li>Job Informations</li>
</ul>
</li>
<li>Warnings</li>
<li>Variables</li>
</ul>
</li>
<li>Missing Values
<ul>
<li>List of Missing Values</li>
<li>Visualization</li>
</ul>
</li>
<li>Unique Values
<ul>
<li>Categorical Variables</li>
<li>Numerical Variables</li>
</ul>
</li>
<li>Outliers</li>
<li>Samples
<ul>
<li>Duplicated</li>
<li>Heads</li>
<li>Tails</li>
</ul>
</li>
</ul>
</div>
<div id="some-arguments-for-dynamic-web-report" class="section level4">
<h4 class="hasAnchor">
<a href="#some-arguments-for-dynamic-web-report" class="anchor"></a>Some arguments for dynamic web report</h4>
<p>diagnose_web_report() generates various reports with the following arguments.</p>
<ul>
<li>output_file
<ul>
<li>name of generated file.</li>
</ul>
</li>
<li>output_dir
<ul>
<li>name of directory to generate report file.</li>
</ul>
</li>
<li>title
<ul>
<li>title of report.</li>
</ul>
</li>
<li>subtitle
<ul>
<li>subtitle of report.</li>
</ul>
</li>
<li>author
<ul>
<li>author of report.</li>
</ul>
</li>
<li>title_color
<ul>
<li>color of title.</li>
</ul>
</li>
<li>thres_uniq_cat
<ul>
<li>threshold to use for “Unique Values - Categorical Variables”.</li>
</ul>
</li>
<li>thres_uniq_num
<ul>
<li>threshold to use for “Unique Values - Numerical Variables”.</li>
</ul>
</li>
<li>logo_img
<ul>
<li>name of logo image file on top left.</li>
</ul>
</li>
<li>create_date
<ul>
<li>The date on which the report is generated.</li>
</ul>
</li>
<li>theme
<ul>
<li>name of theme for report. support “orange” and “blue”.</li>
</ul>
</li>
<li>sample_percent
<ul>
<li>Sample percent of data for performing Diagnosis.</li>
</ul>
</li>
</ul>
<p>The following script creates a quality diagnosis report for the <code>tbl_df</code> class object, <code>flights</code>.</p>
<div class="sourceCode" id="cb23"><html><body><pre class="r"><span class="no">flights</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/diagnose_web_report.data.frame.html">diagnose_web_report</a></span>(<span class="kw">subtitle</span> <span class="kw">=</span> <span class="st">"flights"</span>, <span class="kw">output_dir</span> <span class="kw">=</span> <span class="st">"./"</span>,
                      <span class="kw">output_file</span> <span class="kw">=</span> <span class="st">"Diagn.html"</span>, <span class="kw">theme</span> <span class="kw">=</span> <span class="st">"blue"</span>)</pre></body></html></div>
</div>
<div id="screenshot-of-dynamic-report" class="section level4">
<h4 class="hasAnchor">
<a href="#screenshot-of-dynamic-report" class="anchor"></a>Screenshot of dynamic report</h4>
<ul>
<li>The part of the report is shown in the following figure.:</li>
</ul>
<div class="figure" style="text-align: center">
<img src="img/diag_web_title.jpg" alt="The part of the report" width="80%"><p class="caption">
The part of the report
</p>
</div>
<ul>
<li>The dynamic contents of the report is shown in the following figure.:</li>
</ul>
<div class="figure" style="text-align: center">
<img src="img/diag_web_content.jpg" alt="The dynamic contents of the report" width="80%"><p class="caption">
The dynamic contents of the report
</p>
</div>
</div>
</div>
<div id="create-a-diagnostic-report-using-diagnose_paged_report" class="section level3">
<h3 class="hasAnchor">
<a href="#create-a-diagnostic-report-using-diagnose_paged_report" class="anchor"></a>Create a diagnostic report using <code>diagnose_paged_report()</code>
</h3>
<p><code><a href="../reference/diagnose_paged_report.data.frame.html">diagnose_paged_report()</a></code> create static report for object inherited from data.frame(<code>tbl_df</code>, <code>tbl</code>, etc) or data.frame.</p>
<div id="contents-of-static-paged-report" class="section level4">
<h4 class="hasAnchor">
<a href="#contents-of-static-paged-report" class="anchor"></a>Contents of static paged report</h4>
<p>The contents of the report are as follows.:</p>
<ul>
<li>Overview
<ul>
<li>Data Structures</li>
<li>Job Informations</li>
<li>Warnings</li>
<li>Variables</li>
</ul>
</li>
<li>Missing Values
<ul>
<li>List of Missing Values</li>
<li>Visualization</li>
</ul>
</li>
<li>Unique Values
<ul>
<li>Categorical Variables</li>
<li>Numerical Variables<br>
</li>
</ul>
</li>
<li>Categorical Variable Diagnosis
<ul>
<li>Top Ranks</li>
</ul>
</li>
<li>Numerical Variable Diagnosis
<ul>
<li>Distribution
<ul>
<li>Zero Values</li>
<li>Minus Values</li>
</ul>
</li>
<li>Outliers
<ul>
<li>List of Outliers</li>
<li>Individual Outliers</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div id="some-arguments-for-static-paged-report" class="section level4">
<h4 class="hasAnchor">
<a href="#some-arguments-for-static-paged-report" class="anchor"></a>Some arguments for static paged report</h4>
<p>diagnose_paged_report() generates various reports with the following arguments.</p>
<ul>
<li>output_format
<ul>
<li>report output type. Choose either “pdf” and “html”.</li>
</ul>
</li>
<li>output_file
<ul>
<li>name of generated file.</li>
</ul>
</li>
<li>output_dir
<ul>
<li>name of directory to generate report file.</li>
</ul>
</li>
<li>title
<ul>
<li>title of report.</li>
</ul>
</li>
<li>subtitle
<ul>
<li>subtitle of report.</li>
</ul>
</li>
<li>abstract_title
<ul>
<li>abstract of report</li>
</ul>
</li>
<li>author
<ul>
<li>author of report.</li>
</ul>
</li>
<li>title_color
<ul>
<li>color of title.</li>
</ul>
</li>
<li>subtitle_color
<ul>
<li>color of subtitle.</li>
</ul>
</li>
<li>thres_uniq_cat
<ul>
<li>threshold to use for “Unique Values - Categorical Variables”.</li>
</ul>
</li>
<li>thres_uniq_num
<ul>
<li>threshold to use for “Unique Values - Numerical Variables”.</li>
</ul>
</li>
<li>flag_content_zero
<ul>
<li>whether to output “Zero Values” information.</li>
</ul>
</li>
<li>flag_content_minus
<ul>
<li>whether to output “Minus Values” information.</li>
</ul>
</li>
<li>flag_content_missing
<ul>
<li>whether to output “Missing Value” information.<br>
</li>
</ul>
</li>
<li>logo_img
<ul>
<li>name of logo image file on top left.</li>
</ul>
</li>
<li>cover_img
<ul>
<li>name of cover image file on center.</li>
</ul>
</li>
<li>create_date
<ul>
<li>The date on which the report is generated.</li>
</ul>
</li>
<li>theme
<ul>
<li>name of theme for report. support “orange” and “blue”.</li>
</ul>
</li>
<li>sample_percent
<ul>
<li>Sample percent of data for performing Diagnosis.</li>
</ul>
</li>
</ul>
<p>The following script creates a quality diagnosis report for the <code>tbl_df</code> class object, <code>flights</code>.</p>
<div class="sourceCode" id="cb24"><html><body><pre class="r"><span class="no">flights</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/diagnose_paged_report.data.frame.html">diagnose_paged_report</a></span>(<span class="kw">subtitle</span> <span class="kw">=</span> <span class="st">"flights"</span>, <span class="kw">output_dir</span> <span class="kw">=</span> <span class="st">"./"</span>,
                        <span class="kw">output_file</span> <span class="kw">=</span> <span class="st">"Diagn.pdf"</span>, <span class="kw">theme</span> <span class="kw">=</span> <span class="st">"blue"</span>)</pre></body></html></div>
</div>
<div id="screenshot-of-static-report" class="section level4">
<h4 class="hasAnchor">
<a href="#screenshot-of-static-report" class="anchor"></a>Screenshot of static report</h4>
<ul>
<li>The cover of the report is shown in the following figure.:</li>
</ul>
<div class="figure" style="text-align: center">
<img src="img/diag_paged_cover.jpg" alt="The part of the report" width="80%"><p class="caption">
The part of the report
</p>
</div>
<ul>
<li>The contents of the report is shown in the following figure.:</li>
</ul>
<div class="figure" style="text-align: center">
<img src="img/diag_paged_content.jpg" alt="The dynamic contents of the report" width="80%"><p class="caption">
The dynamic contents of the report
</p>
</div>
</div>
</div>
</div>
<div id="diagnosing-tables-in-dbms" class="section level2">
<h2 class="hasAnchor">
<a href="#diagnosing-tables-in-dbms" class="anchor"></a>Diagnosing tables in DBMS</h2>
<p>The DBMS table diagnostic function supports In-database mode that performs SQL operations on the DBMS side. If the size of the data is large, using In-database mode is faster.</p>
<p>It is difficult to obtain anomaly or to implement the sampling-based algorithm in SQL of DBMS. So some functions do not yet support In-database mode. In this case, it is performed in In-memory mode in which table data is brought to R side and calculated. In this case, if the data size is large, the execution speed may be slow. It supports the collect_size argument, which allows you to import the specified number of samples of data into R.</p>
<ul>
<li>In-database support functions
<ul>
<li><code>diagonse()</code></li>
<li><code><a href="../reference/diagnose_category.data.frame.html">diagnose_category()</a></code></li>
</ul>
</li>
<li>In-database not support functions
<ul>
<li><code><a href="../reference/diagnose_numeric.data.frame.html">diagnose_numeric()</a></code></li>
<li>
<code><a href="../reference/diagnose_outlier.data.frame.html">diagnose_outlier()</a></code><br>
</li>
<li>
<code><a href="../reference/plot_outlier.data.frame.html">plot_outlier()</a></code><br>
</li>
<li><code><a href="../reference/diagnose_web_report.data.frame.html">diagnose_web_report()</a></code></li>
<li><code><a href="../reference/diagnose_paged_report.data.frame.html">diagnose_paged_report()</a></code></li>
</ul>
</li>
</ul>
<div id="preparing-table-data" class="section level3">
<h3 class="hasAnchor">
<a href="#preparing-table-data" class="anchor"></a>Preparing table data</h3>
<p>Copy the <code>carseats</code> data frame to the SQLite DBMS and create it as a table named <code>TB_CARSEATS</code>. Mysql/MariaDB, PostgreSQL, Oracle DBMS, other DBMS are also available for your environment.</p>
<div class="sourceCode" id="cb25"><html><body><pre class="r"><span class="kw">if</span> (!<span class="fu"><a href="https://rdrr.io/r/base/library.html">require</a></span>(<span class="no">DBI</span>)) <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">'DBI'</span>)
<span class="kw">if</span> (!<span class="fu"><a href="https://rdrr.io/r/base/library.html">require</a></span>(<span class="no">RSQLite</span>)) <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">'RSQLite'</span>)
<span class="kw">if</span> (!<span class="fu"><a href="https://rdrr.io/r/base/library.html">require</a></span>(<span class="no">dplyr</span>)) <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">'dplyr'</span>)
<span class="kw">if</span> (!<span class="fu"><a href="https://rdrr.io/r/base/library.html">require</a></span>(<span class="no">dbplyr</span>)) <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">'dbplyr'</span>)

<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)

<span class="no">carseats</span> <span class="kw">&lt;-</span> <span class="kw pkg">ISLR</span><span class="kw ns">::</span><span class="no"><a href="https://rdrr.io/pkg/ISLR/man/Carseats.html">Carseats</a></span>
<span class="no">carseats</span>[<span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">NROW</a></span>(<span class="no">carseats</span>)), <span class="fl">20</span>), <span class="st">"Income"</span>] <span class="kw">&lt;-</span> <span class="fl">NA</span>
<span class="no">carseats</span>[<span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">NROW</a></span>(<span class="no">carseats</span>)), <span class="fl">5</span>), <span class="st">"Urban"</span>] <span class="kw">&lt;-</span> <span class="fl">NA</span>

<span class="co"># connect DBMS</span>
<span class="no">con_sqlite</span> <span class="kw">&lt;-</span> <span class="kw pkg">DBI</span><span class="kw ns">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbConnect.html">dbConnect</a></span>(<span class="kw pkg">RSQLite</span><span class="kw ns">::</span><span class="fu"><a href="https://rsqlite.r-dbi.org/reference/SQLite.html">SQLite</a></span>(), <span class="st">":memory:"</span>)

<span class="co"># copy carseats to the DBMS with a table named TB_CARSEATS</span>
<span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/copy_to.html">copy_to</a></span>(<span class="no">con_sqlite</span>, <span class="no">carseats</span>, <span class="kw">name</span> <span class="kw">=</span> <span class="st">"TB_CARSEATS"</span>, <span class="kw">overwrite</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
</div>
<div id="diagnose-data-quality-of-variables-in-the-dbms" class="section level3">
<h3 class="hasAnchor">
<a href="#diagnose-data-quality-of-variables-in-the-dbms" class="anchor"></a>Diagnose data quality of variables in the DBMS</h3>
<p>Use <code><a href="https://rdrr.io/pkg/dplyr/man/tbl.html">dplyr::tbl()</a></code> to create a tbl_dbi object, then use it as a data frame object. That is, the data argument of all diagnose function is specified as tbl_dbi object instead of data frame object.</p>
<div class="sourceCode" id="cb26"><html><body><pre class="r"># Diagnosis of all columns
con_sqlite %&gt;% 
  tbl("TB_CARSEATS") %&gt;% 
  diagnose()
# A tibble: 11 x 6
  variables   types  missing_count missing_percent unique_count unique_rate
  &lt;chr&gt;       &lt;chr&gt;          &lt;dbl&gt;           &lt;dbl&gt;        &lt;int&gt;       &lt;dbl&gt;
1 Sales       double             0               0          336       0.84 
2 CompPrice   double             0               0           73       0.182
3 Income      double            20               5           99       0.248
4 Advertising double             0               0           28       0.07 
# … with 7 more rows

# Positions values select columns, and In-memory mode
con_sqlite %&gt;% 
  tbl("TB_CARSEATS") %&gt;% 
  diagnose(1, 3, 8, in_database = FALSE)
# A tibble: 3 x 6
  variables types   missing_count missing_percent unique_count unique_rate
  &lt;chr&gt;     &lt;chr&gt;           &lt;int&gt;           &lt;dbl&gt;        &lt;int&gt;       &lt;dbl&gt;
1 Sales     numeric             0               0          336       0.84 
2 Income    numeric            20               5           99       0.248
3 Age       numeric             0               0           56       0.14 
  
# Positions values select columns, and In-memory mode and collect size is 200
con_sqlite %&gt;% 
  tbl("TB_CARSEATS") %&gt;% 
  diagnose(-8, -9, -10, in_database = FALSE, collect_size = 200)
# A tibble: 8 x 6
  variables   types   missing_count missing_percent unique_count unique_rate
  &lt;chr&gt;       &lt;chr&gt;           &lt;int&gt;           &lt;dbl&gt;        &lt;int&gt;       &lt;dbl&gt;
1 Sales       numeric             0               0          182       0.91 
2 CompPrice   numeric             0               0           65       0.325
3 Income      numeric             8               4           83       0.415
4 Advertising numeric             0               0           23       0.115
# … with 4 more rows</pre></body></html></div>
</div>
<div id="diagnose-data-quality-of-categorical-variables-in-the-dbms" class="section level3">
<h3 class="hasAnchor">
<a href="#diagnose-data-quality-of-categorical-variables-in-the-dbms" class="anchor"></a>Diagnose data quality of categorical variables in the DBMS</h3>
<div class="sourceCode" id="cb27"><html><body><pre class="r"># Positions values select variables, and In-memory mode and collect size is 200
con_sqlite %&gt;% 
  tbl("TB_CARSEATS") %&gt;% 
  diagnose_category(7, in_database = FALSE, collect_size = 200) 
# A tibble: 3 x 6
  variables levels     N  freq ratio  rank
  &lt;chr&gt;     &lt;chr&gt;  &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;int&gt;
1 ShelveLoc Medium   200   113  56.5     1
2 ShelveLoc Bad      200    47  23.5     2
3 ShelveLoc Good     200    40  20       3
  
# Positions values select variables
con_sqlite %&gt;% 
  tbl("TB_CARSEATS") %&gt;% 
  diagnose_category(-7)
# A tibble: 5 x 6
  variables levels     N  freq ratio  rank
  &lt;chr&gt;     &lt;chr&gt;  &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;int&gt;
1 Urban     Yes      400   280 70        1
2 Urban     No       400   115 28.7      2
3 Urban     &lt;NA&gt;     400     5  1.25     3
4 US        Yes      400   258 64.5      1
# … with 1 more row</pre></body></html></div>
</div>
<div id="diagnose-data-quality-of-numerical-variables-in-the-dbms" class="section level3">
<h3 class="hasAnchor">
<a href="#diagnose-data-quality-of-numerical-variables-in-the-dbms" class="anchor"></a>Diagnose data quality of numerical variables in the DBMS</h3>
<div class="sourceCode" id="cb28"><html><body><pre class="r"># Diagnosis of all numerical variables
con_sqlite %&gt;% 
  tbl("TB_CARSEATS") %&gt;% 
  diagnose_numeric()
# A tibble: 8 x 10
  variables     min     Q1   mean median     Q3   max  zero minus outlier
  &lt;chr&gt;       &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt;   &lt;int&gt;
1 Sales           0   5.39   7.50   7.49   9.32  16.3     1     0       2
2 CompPrice      77 115    125.   125    135    175       0     0       2
3 Income         21  42     68.1   69     90.2  120       0     0       0
4 Advertising     0   0      6.64   5     12     29     144     0       0
# … with 4 more rows
  
# Positive values select variables, and In-memory mode and collect size is 200
con_sqlite %&gt;% 
  tbl("TB_CARSEATS") %&gt;% 
  diagnose_numeric(Sales, Income, collect_size = 200)
# A tibble: 2 x 10
  variables   min    Q1  mean median    Q3   max  zero minus outlier
* &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt;   &lt;int&gt;
1 Sales         0  5.26  7.42   7.50  9.10  14.9     1     0       0
2 Income       21 46.8  71.3   73.5  93    120       0     0       0</pre></body></html></div>
</div>
<div id="diagnose-outlier-of-numerical-variables-in-the-dbms" class="section level3">
<h3 class="hasAnchor">
<a href="#diagnose-outlier-of-numerical-variables-in-the-dbms" class="anchor"></a>Diagnose outlier of numerical variables in the DBMS</h3>
<div class="sourceCode" id="cb29"><html><body><pre class="r">con_sqlite %&gt;% 
  tbl("TB_CARSEATS") %&gt;% 
  diagnose_outlier()  %&gt;%
  filter(outliers_ratio &gt; 1)
# A tibble: 1 x 6
  variables outliers_cnt outliers_ratio outliers_mean with_mean without_mean
  &lt;chr&gt;            &lt;int&gt;          &lt;dbl&gt;         &lt;dbl&gt;     &lt;dbl&gt;        &lt;dbl&gt;
1 Price                5           1.25          100.      116.         116.</pre></body></html></div>
</div>
<div id="plot-outlier-information-of-numerical-data-diagnosis-in-the-dbms" class="section level3">
<h3 class="hasAnchor">
<a href="#plot-outlier-information-of-numerical-data-diagnosis-in-the-dbms" class="anchor"></a>Plot outlier information of numerical data diagnosis in the DBMS</h3>
<div class="sourceCode" id="cb30"><html><body><pre class="r"><span class="co"># Visualization of numerical variables with a ratio of</span>
<span class="co"># outliers greater than 1%</span>
<span class="co"># the result is same as a data.frame, but not display here. reference above in document.</span>
<span class="no">con_sqlite</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/tbl.html">tbl</a></span>(<span class="st">"TB_CARSEATS"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/plot_outlier.data.frame.html">plot_outlier</a></span>(<span class="no">con_sqlite</span> <span class="kw">%&gt;%</span>
                 <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/tbl.html">tbl</a></span>(<span class="st">"TB_CARSEATS"</span>) <span class="kw">%&gt;%</span>
                 <span class="fu"><a href="../reference/diagnose_outlier.data.frame.html">diagnose_outlier</a></span>() <span class="kw">%&gt;%</span>
                 <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span>(<span class="no">outliers_ratio</span> <span class="kw">&gt;</span> <span class="fl">1</span>) <span class="kw">%&gt;%</span>
                 <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/select.html">select</a></span>(<span class="no">variables</span>) <span class="kw">%&gt;%</span>
                 <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/pull.html">pull</a></span>())</pre></body></html></div>
</div>
<div id="reporting-the-information-of-data-diagnosis-for-table-of-thr-dbms" class="section level3">
<h3 class="hasAnchor">
<a href="#reporting-the-information-of-data-diagnosis-for-table-of-thr-dbms" class="anchor"></a>Reporting the information of data diagnosis for table of thr DBMS</h3>
<p>The following shows several examples of creating an data diagnosis report for a DBMS table.</p>
<p>Using the <code>collect_size</code> argument, you can perform data diagnosis with the corresponding number of sample data. If the number of data is very large, use <code>collect_size</code>.</p>
<div class="sourceCode" id="cb31"><html><body><pre class="r"><span class="co"># create web report file. </span>
<span class="no">con_sqlite</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/tbl.html">tbl</a></span>(<span class="st">"TB_CARSEATS"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/diagnose_web_report.data.frame.html">diagnose_web_report</a></span>()

<span class="co"># create pdf file. file name is Diagn.pdf, and collect size is 350</span>
<span class="no">con_sqlite</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/tbl.html">tbl</a></span>(<span class="st">"TB_CARSEATS"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/diagnose_paged_report.data.frame.html">diagnose_paged_report</a></span>(<span class="kw">collect_size</span> <span class="kw">=</span> <span class="fl">350</span>, <span class="kw">output_file</span> <span class="kw">=</span> <span class="st">"Diagn.pdf"</span>)</pre></body></html></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Choonghyun Ryu.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
